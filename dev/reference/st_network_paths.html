<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find shortest paths between nodes in a spatial network — st_network_paths • sfnetworks</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find shortest paths between nodes in a spatial network — st_network_paths"><meta name="description" content="Find shortest paths between nodes in a spatial network"><meta property="og:description" content="Find shortest paths between nodes in a spatial network"><meta property="og:image" content="https://luukvdmeer.github.io/sfnetworks/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sfnetworks</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.9.9.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/sfn01_intro.html">Introduction to sfnetworks</a></li>
    <li><a class="dropdown-item" href="../articles/sfn02_create_represent.html">Creating and representing spatial networks</a></li>
    <li><a class="dropdown-item" href="../articles/sfn03_cleaning.html">Cleaning spatial networks</a></li>
    <li><a class="dropdown-item" href="../articles/sfn04_join_filter.html">Spatial joins and filters</a></li>
    <li><a class="dropdown-item" href="../articles/sfn05_routing.html">Routing on spatial networks</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/luukvdmeer/sfnetworks/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Find shortest paths between nodes in a spatial network</h1>
      <small class="dont-index">Source: <a href="https://github.com/luukvdmeer/sfnetworks/blob/main/R/paths.R" class="external-link"><code>R/paths.R</code></a></small>
      <div class="d-none name"><code>st_network_paths.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Find shortest paths between nodes in a spatial network</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">st_network_paths</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">from</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="ids.html">node_ids</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="fu"><a href="spatial_edge_measures.html">edge_length</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  direction <span class="op">=</span> <span class="st">"out"</span>,</span>
<span>  router <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"sfn_default_router"</span>, <span class="st">"igraph"</span><span class="op">)</span>,</span>
<span>  use_names <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_cost <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_geometry <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code><a href="sfnetwork.html">sfnetwork</a></code>.</p></dd>


<dt id="arg-from">from<a class="anchor" aria-label="anchor" href="#arg-from"></a></dt>
<dd><p>The node where the paths should start. Evaluated by
<code><a href="evaluate_node_query.html">evaluate_node_query</a></code>.</p></dd>


<dt id="arg-to">to<a class="anchor" aria-label="anchor" href="#arg-to"></a></dt>
<dd><p>The nodes where the paths should end. Evaluated by
<code><a href="evaluate_node_query.html">evaluate_node_query</a></code>. By default, all nodes in the network are
included.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>The edge weights to be used in the shortest path calculation.
Evaluated by <code><a href="evaluate_weight_spec.html">evaluate_weight_spec</a></code>. The default is
<code><a href="spatial_edge_measures.html">edge_length</a></code>, which computes the geographic lengths of the
edges.</p></dd>


<dt id="arg-all">all<a class="anchor" aria-label="anchor" href="#arg-all"></a></dt>
<dd><p>Should all shortest paths be returned for each pair of nodes? If
set to <code>FALSE</code>, only one shortest path is returned for each pair of
nodes, even if multiple shortest paths exist. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>The number of paths to find. Setting this to any integer higher
than 1 returns not only the shortest path, but also the next k - 1 loopless
shortest paths, which may be longer than the shortest path. Currently, this
is only supported for one-to-one routing, meaning that both the from and to
argument should be of length 1. This argument is ignored if <code>all</code> is
set to <code>TRUE</code>.</p></dd>


<dt id="arg-direction">direction<a class="anchor" aria-label="anchor" href="#arg-direction"></a></dt>
<dd><p>The direction of travel. Defaults to <code>'out'</code>, meaning
that the direction given by the network is followed and paths are found from
the node given as argument <code>from</code>. May be set to <code>'in'</code>, meaning
that the opposite direction is followed an paths are found towards the node
given as argument <code>from</code>. May also be set to <code>'all'</code>, meaning that
the network is considered to be undirected. This argument is ignored for
undirected networks.</p></dd>


<dt id="arg-router">router<a class="anchor" aria-label="anchor" href="#arg-router"></a></dt>
<dd><p>The routing backend to use for the shortest path computation.
Currently supported options are <code>'igraph'</code> and <code>'dodgr'</code>. See
Details.</p></dd>


<dt id="arg-use-names">use_names<a class="anchor" aria-label="anchor" href="#arg-use-names"></a></dt>
<dd><p>If a column named <code>name</code> is present in the nodes
table, should these names be used to encode the nodes in a path, instead of
the node indices? Defaults to <code>FALSE</code>. Ignored when the nodes table does
not have a column named <code>name</code>.</p></dd>


<dt id="arg-return-cost">return_cost<a class="anchor" aria-label="anchor" href="#arg-return-cost"></a></dt>
<dd><p>Should the total cost of each path be computed? Defaults
to <code>TRUE</code>.</p></dd>


<dt id="arg-return-geometry">return_geometry<a class="anchor" aria-label="anchor" href="#arg-return-geometry"></a></dt>
<dd><p>Should a linestring geometry be constructed for each
path? Defaults to <code>TRUE</code>. The geometries are constructed by calling
<code><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_line_merge</a></code> on the linestring geometries of the edges in
the path. Ignored for networks with spatially implicit edges.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed on to the underlying function of the
chosen routing backend. See Details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> with one row per requested
path. If <code>return_geometry = FALSE</code> or edges are spatially implicit, a
<code><a href="https://tibble.tidyverse.org/reference/tbl_df-class.html" class="external-link">tbl_df</a></code> is returned instead. If a requested path could
not be found, it is included in the output as an empty path.</p>
<p>Depending on the argument settings, the output may include the following
columns:</p>
<ul><li><p><code>from</code>: The index of the node at the start of the path.</p></li>
<li><p><code>to</code>: The index of the node at the end of the path.</p></li>
<li><p><code>node_path</code>: A vector containing the indices of all nodes on
  the path, in order of visit.</p></li>
<li><p><code>edge_path</code>: A vector containing the indices of all edges on
  the path, in order of visit.</p></li>
<li><p><code>path_found</code>: A boolean describing if the requested path exists.</p></li>
<li><p><code>cost</code>: The total cost of the path, obtained by summing the
  weights of all visited edges. Included if <code>return_cost = TRUE</code>.</p></li>
<li><p><code>geometry</code>: The geometry of the path, obtained by merging the
  geometries of all visited edges. Included if <code>return_geometry = TRUE</code>
  and the network has spatially explicit edges.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The sfnetworks package does not implement its own routing algorithms
to find shortest paths. Instead, it relies on "routing backends", i.e. other
R packages that have implemented such algorithms. Currently two different
routing backends are supported.</p>
<p>The default is <code><a href="https://r.igraph.org/reference/aaa-igraph-package.html" class="external-link">igraph</a></code>. This package supports
one-to-many shortest path calculation with the
<code><a href="https://r.igraph.org/reference/distances.html" class="external-link">shortest_paths</a></code> function. Note that multiple from nodes
are not supported. If multiple from nodes are given, only the first one is
taken. The igraph router also supports the computation of all shortest path
(see the <code>all</code> argument) through the
<code><a href="https://r.igraph.org/reference/distances.html" class="external-link">all_shortest_paths</a></code> function and of k shortest paths
(see the <code>k</code> argument) through the
<code><a href="https://r.igraph.org/reference/k_shortest_paths.html" class="external-link">k_shortest_paths</a></code> function. In the latter case, only
one-to-one routing is supported, meaning that also only one to node should
be provided. The igraph router does not support dual-weighted routing.</p>
<p>The second supported routing backend is <code><a href="https://UrbanAnalyst.github.io/dodgr/reference/dodgr.html" class="external-link">dodgr</a></code>. This
package supports many-to-many shortest path calculation with the
<code><a href="https://UrbanAnalyst.github.io/dodgr/reference/dodgr_paths.html" class="external-link">dodgr_paths</a></code> function. It also supports dual-weighted
routing. The computation of all shortest paths and k shortest paths is
currently not supported by the dodgr router. The dodgr package is a
conditional dependency of sfnetworks. Using the dodgr router requires the
dodgr package to be installed.</p>
<p>The default router can be changed by setting the <code>sfn_default_router</code>
option.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="st_network_cost.html">st_network_cost</a></code>, <code><a href="st_network_travel.html">st_network_travel</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">oldpar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">=</span> <span class="fu"><a href="as_sfnetwork.html">as_sfnetwork</a></span><span class="op">(</span><span class="va">roxel</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="fl">3035</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the shortest path between two nodes.</span></span></span>
<span class="r-in"><span><span class="co"># Note that geographic edge length is used as edge weights by default.</span></span></span>
<span class="r-in"><span><span class="va">paths</span> <span class="op">=</span> <span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>, from <span class="op">=</span> <span class="fl">495</span>, to <span class="op">=</span> <span class="fl">121</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">paths</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4152025 ymin: 3207259 xmax: 4152176 ymax: 3207843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path  edge_path  path_found cost                     geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494;">[m]</span>             <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   495   121 <span style="color: #949494;">&lt;dbl [15]&gt;</span> <span style="color: #949494;">&lt;dbl [14]&gt;</span> TRUE       670. (4152096 3207259, 4152130 3…</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">[</span><span class="va">paths</span><span class="op">$</span><span class="va">from</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="st_network_paths-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the shortest paths from one to multiple nodes.</span></span></span>
<span class="r-in"><span><span class="co"># This will return a tibble with one row per path.</span></span></span>
<span class="r-in"><span><span class="va">paths</span> <span class="op">=</span> <span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>, from <span class="op">=</span> <span class="fl">495</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">121</span>, <span class="fl">131</span>, <span class="fl">141</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">paths</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 3 features and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4151719 ymin: 3206620 xmax: 4152176 ymax: 3207957</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path  edge_path  path_found  cost                    geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>        <span style="color: #949494;">[m]</span>            <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   495   121 <span style="color: #949494;">&lt;dbl [15]&gt;</span> <span style="color: #949494;">&lt;dbl [14]&gt;</span> TRUE        670. (4152096 3207259, 4152130 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>   495   131 <span style="color: #949494;">&lt;dbl [31]&gt;</span> <span style="color: #949494;">&lt;dbl [30]&gt;</span> TRUE       <span style="text-decoration: underline;">1</span>496. (4151720 3206620, 4151719 …</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>   495   141 <span style="color: #949494;">&lt;dbl [11]&gt;</span> <span style="color: #949494;">&lt;dbl [10]&gt;</span> TRUE        214. (4152055 3207957, 4151998 …</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">[</span><span class="va">paths</span><span class="op">$</span><span class="va">from</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="st_network_paths-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the shortest path between two spatial point features.</span></span></span>
<span class="r-in"><span><span class="co"># These are snapped to their nearest node before finding the path.</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">net</span>, <span class="st">"nodes"</span><span class="op">)</span><span class="op">[</span><span class="fl">495</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="op">-</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">net</span>, <span class="st">"nodes"</span><span class="op">)</span><span class="op">[</span><span class="fl">121</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">paths</span> <span class="op">=</span> <span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>, from <span class="op">=</span> <span class="va">p1</span>, to <span class="op">=</span> <span class="va">p2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">paths</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4152060 ymin: 3207348 xmax: 4152221 ymax: 3207784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path  edge_path  path_found cost                     geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494;">[m]</span>             <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   477   216 <span style="color: #949494;">&lt;dbl [12]&gt;</span> <span style="color: #949494;">&lt;dbl [11]&gt;</span> TRUE       586. (4152060 3207348, 4152122 3…</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">net</span>, col <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">net</span><span class="op">)</span><span class="op">[</span><span class="va">paths</span><span class="op">$</span><span class="va">from</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">4</span>, cex <span class="op">=</span> <span class="fl">2</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">paths</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"orange"</span>, lwd <span class="op">=</span> <span class="fl">3</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="st_network_paths-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a node type query function to specify destinations.</span></span></span>
<span class="r-in"><span><span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>, <span class="fl">1</span>, <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/node_types.html" class="external-link">node_is_adjacent</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 4 features and 6 fields (with 1 geometry empty)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4151754 ymin: 3207609 xmax: 4151785 ymax: 3207727</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 4 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path edge_path path_found   cost                     geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>         <span style="color: #949494;">[m]</span>             <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>     1     1 <span style="color: #949494;">&lt;dbl [1]&gt;</span> <span style="color: #949494;">&lt;dbl [0]&gt;</span> TRUE         0                           EMPTY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>     1     2 <span style="color: #949494;">&lt;dbl [2]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> TRUE        17.2  (4151782 3207612, 4151765 3…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span>     1   393 <span style="color: #949494;">&lt;dbl [2]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> TRUE       119.   (4151757 3207727, 4151754 3…</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span>     1   624 <span style="color: #949494;">&lt;dbl [2]&gt;</span> <span style="color: #949494;">&lt;dbl [1]&gt;</span> TRUE         2.88 (4151785 3207613, 4151782 3…</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a spatial edge measure to specify edge weights.</span></span></span>
<span class="r-in"><span><span class="co"># By default edge_length() is used.</span></span></span>
<span class="r-in"><span><span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>, <span class="va">p1</span>, <span class="va">p2</span>, weights <span class="op">=</span> <span class="fu"><a href="spatial_edge_measures.html">edge_displacement</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4152060 ymin: 3207348 xmax: 4152221 ymax: 3207784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path  edge_path  path_found cost                     geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>       <span style="color: #949494;">[m]</span>             <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   477   216 <span style="color: #949494;">&lt;dbl [12]&gt;</span> <span style="color: #949494;">&lt;dbl [11]&gt;</span> TRUE       584. (4152060 3207348, 4152122 3…</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a column in the edges table to specify edge weights.</span></span></span>
<span class="r-in"><span><span class="co"># This uses tidy evaluation.</span></span></span>
<span class="r-in"><span><span class="va">net</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="st">"edges"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="n.html">n</a></span><span class="op">(</span><span class="op">)</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">st_network_paths</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, weights <span class="op">=</span> <span class="va">foo</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4152060 ymin: 3207348 xmax: 4152244 ymax: 3207784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path  edge_path  path_found  cost                    geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   477   216 <span style="color: #949494;">&lt;dbl [11]&gt;</span> <span style="color: #949494;">&lt;dbl [10]&gt;</span> TRUE        4.57 (4152060 3207348, 4152122 …</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the shortest paths without edge weights.</span></span></span>
<span class="r-in"><span><span class="co"># This is the path with the fewest number of edges, ignoring space.</span></span></span>
<span class="r-in"><span><span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>, <span class="va">p1</span>, <span class="va">p2</span>, weights <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simple feature collection with 1 feature and 6 fields</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Geometry type: LINESTRING</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimension:     XY</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bounding box:  xmin: 4152060 ymin: 3207348 xmax: 4152180 ymax: 3207784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Projected CRS: ETRS89-extended / LAEA Europe</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from    to node_path  edge_path  path_found  cost                    geometry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;LINESTRING [m]&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>   477   216 <span style="color: #949494;">&lt;dbl [11]&gt;</span> <span style="color: #949494;">&lt;dbl [10]&gt;</span> TRUE          10 (4152060 3207348, 4152122 …</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the dodgr router for many-to-many routing.</span></span></span>
<span class="r-in"><span><span class="va">paths</span> <span class="op">=</span> <span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>,</span></span>
<span class="r-in"><span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  router <span class="op">=</span> <span class="st">"dodgr"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use the dodgr router for dual-weighted routing.</span></span></span>
<span class="r-in"><span><span class="va">paths</span> <span class="op">=</span> <span class="fu">st_network_paths</span><span class="op">(</span><span class="va">net</span>,</span></span>
<span class="r-in"><span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">11</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  weights <span class="op">=</span> <span class="fu"><a href="dual_weights.html">dual_weights</a></span><span class="op">(</span><span class="fu"><a href="spatial_edge_measures.html">edge_segment_count</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="spatial_edge_measures.html">edge_length</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  router <span class="op">=</span> <span class="st">"dodgr"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucas van der Meer, Lorena Abad, Andrea Gilardi, Robin Lovelace.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

